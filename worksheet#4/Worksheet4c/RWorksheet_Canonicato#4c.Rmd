---
title: "RWorksheet_Canonicato#4c"
author: "Dianah Marie Canonicato"
date: "2023-11-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#1. Use the dataset mpg
```{r}

#a. Show your solutions on how to import a csv file into the environment.
library(readr)
mpg <- read.csv("mpg.csv")
mpg
```
#b. Which variables from mpg dataset are categorical?
```{r}
str(mpg)
```

#c. Which are continuous variables?

```{r}
continuous_vars <- c("displ", "year", "cyl", "cty", "hwy")
continuous_vars

```


#2. Which manufacturer has the most models in this data set? Which model has the most variations?

```{r}
#a. Group the manufacturers and find the unique models. Show your codes and result.
# Assuming 'df' is your data frame

# Get the frequency of each manufacturer
manufacturer_counts <- table(mpg$manufacturer)

# Find the manufacturer with the most models
most_models_manufacturer <- as.character(names(manufacturer_counts)[which.max(manufacturer_counts)])

# Get the frequency of each model
model_counts <- table(mpg$model)

# Find the model with the most variations
most_variations_model <- as.character(names(model_counts)[which.max(model_counts)])

# Print the results
print(paste("The manufacturer with the most models is:", most_models_manufacturer))
print(paste("The model with the most variations is:", most_variations_model))

```

#b. Graph the result by using plot() and ggplot(). Write the codes and its result.
```{r}
# Count the number of unique models for each manufacturer
model_counts <- aggregate(mpg$model, by=list(mpg$manufacturer), FUN=length)

# Rename the columns for better readability
colnames(model_counts) <- c("Manufacturer", "Model_Count")

# Create a bar plot to visualize the data
library(ggplot2)
ggplot(model_counts, aes(x=Manufacturer, y=Model_Count)) +
 geom_bar(stat="identity", fill="pink") +
 labs(title="Number of Unique Models by Manufacturer",
       x="Manufacturer",
       y="Number of Models") +
 theme_minimal()



```
#3. Same dataset will be used. You are going to show the relationship of the model and the manufacturer.
```{r}
#a. What does ggplot(mpg, aes(model, manufacturer)) + geom_point() show?

library(ggplot2)
ggplot(mpg, aes(model, manufacturer)) + geom_point()


```
#b. For you, is it useful? If not, how could you modify the data to make it more informative?
```{r}
#The plot shows the relationship between the model and the manufacturer. It can be useful to visualize the distribution of models across different manufacturers. To make it more informative, we can add color or size aesthetics to represent additional variables, such as the number of cylinders or fuel type.


library(ggplot2)

# Assuming your data is stored in a dataframe called "df"

# Display the top 20 observations
head(mpg, 20)

# Plot the model and the year
ggplot(data = mpg, aes(x = year, y = model, color = as.factor(model))) +
 geom_point(alpha = 0.7) +
 labs(title = "Relationship between Model, Year, and Manufacturer",
       x = "Year",
       y = "Model",
       color = "Manufacturer") +
 theme_minimal()

```
#4. Using the pipe (%>%), group the model and get the number of cars per model. Show codes and its result
```{r}
#a. Plot using geom_bar() using the top 20 observations only. The graphs should have a title, labels and colors. Show code and results.

library(dplyr)
library(ggplot2)

# Assuming your data is stored in a dataframe called "df"

# Display the top 20 observations
head(mpg, 20)

# Group the model and get the number of cars per model
mpg %>%
 group_by(model) %>%
 summarise(count = n()) -> grouped_mpg

# Display the result
print(grouped_mpg)


```

```{r}
#b. Plot using the geom_bar() + coord_flip() just like what is shown below. Show codes and its result.

# Create a dataframe containing the top 20 observations only
top_20 <- mpg %>%
 group_by(model) %>%
 summarise(count = n()) %>%
 arrange(desc(count)) %>%
 head(20)

# Create a plot using geom_bar()
plot <- ggplot(top_20, aes(x = reorder(model, count), y = count, fill = model)) +
 geom_bar(stat = "identity", color = "black") +
 scale_fill_brewer(palette = "Set2") +
 coord_flip() +
 labs(title = "Top 20 Most Popular Car Models",
       x = "Model",
       y = "Number of Cars") +
 theme_minimal() +
 theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1))

# Display the plot
print(plot)

```
#5. Plot the relationship between cyl - number of cylinders and displ - engine displacement using geom_point with aesthetic color = engine displacement. Title should be “Relationship between No. of Cylinders and Engine Displacement”.

```{r}
#a. How would you describe its relationship? Show the codes and its result
# Dummy data
mpg <- data.frame(model = sample(letters[1:20], 1000, replace = TRUE))

# Code for creating the plot
top_20 <- mpg %>%
 group_by(model) %>%
 summarise(count = n()) %>%
 arrange(desc(count)) %>%
 head(20)

top_20 <- top_20 %>%
 group_by(model) %>%
 head(8)

plot <- ggplot(top_20, aes(x = reorder(model, count), y = count, fill = model)) +
 geom_bar(stat = "identity", color = "black") +
 scale_fill_brewer(palette = "Set2") +
 coord_flip() +
 labs(title = "Top 20 Most Popular Car Models",
       x = "Model",
       y = "Number of Cars") +
 theme_minimal() +
 theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1))

print(plot)



```

#6. Plot the relationship between displ (engine displacement) and hwy(highway miles per gallon). Mapped it with a continuous variable you have identified in #1-c. What is its result? Why it produced such output?

```{r}
#6. Import the traffic.csv onto your R environment.
#a. How many numbers of observation does it have? What are the variables of the traffic dataset the Show your answer.


```

```{r}
#b. subset the traffic dataset into junctions. What is the R codes and its output?
```

```{r}
# c. Plot each junction in a using geom_line(). Show your solution and output.
```
#7. From alexa_file.xlsx, import it to your environment
```{r}
#a. How many observations does alexa_file has? What about the number of columns? Show your solution and answer.

```

```{r}
#b. group the variations and get the total of each variations. Use dplyr package. Show solution and answer
```

```{r}
#c. Plot the variations using the ggplot() function. What did you observe? Complete the details of the graph. Show solution and answer.

```

```{r}
#d. Plot a geom_line() with the date and the number of verified reviews. Complete the details of the graphs. Show your answer and solution.
```

```{r}
#e. Get the relationship of variations and ratings. Which variations got the most highest in rating? Plot a graph to show its relationship. Show your solution and answer
```
